version: "3.4"
services:
  redis:
    image: redis:5-alpine
  scheduler:
    image: "amir20/clashleaders:${TAG:-latest}"
    command: "scheduler"
  worker:
    image: "amir20/clashleaders:${TAG:-latest}"
    command: "worker"
  web:
    build: .
    image: "amir20/clashleaders:${TAG:-latest}"
    depends_on:
      - redis
  player_worker:
    image: "amir20/clashleaders:${TAG:-latest}"
    command: "rq_worker player"
    depends_on:
      - redis
  calculation_worker:
    image: "amir20/clashleaders:${TAG:-latest}"
    command: "rq_worker calculation"
    depends_on:
      - redis
