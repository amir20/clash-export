https://www.clashleaders.com {
    root /app/clashleaders

    tls {
        dns digitalocean
    }

    proxy / unix:/tmp/gunicorn.sock {
        transparent
        except /favicon.ico /robots.txt /static
    }

    expires {
        match /static 1y
    }

    header /static {
        Cache-Control "public, max-age=31536000"
    }

    header / {
        # Enable HTTP Strict Transport Security (HSTS) to force clients to always
        # connect via HTTPS (do not use if only testing)
        Strict-Transport-Security "max-age=31536000;"
        # Enable cross-site filter (XSS) and tell browser to block detected attacks
        X-XSS-Protection "1; mode=block"
        # Prevent some browsers from MIME-sniffing a response away from the declared Content-Type
        X-Content-Type-Options "nosniff"
        # Disallow the site to be rendered within a frame (clickjacking protection)
        X-Frame-Options "DENY"
    }

    gzip
    log / stdout "[{when}] \"{method} {uri} {proto}\" {status} {size} \"{>User-Agent}\"" {
        except /static
    }
    errors stdout
}

https://i.clashleaders.com {
    tls {
        dns digitalocean
    }

    cache {
        default_max_age 1h
    }

    proxy / imgproxy:8080 {
        transparent
    }

    log / stdout "[{when}] \"{method} {uri} {proto}\" {status} {size} \"{>User-Agent}\""
    errors stdout
}

http://clashleaders.com {
   redir https://www.clashleaders.com{uri}
   tls off
}

localhost:8000 {
   proxy / unix:/tmp/gunicorn.sock {
        transparent
    }
}
