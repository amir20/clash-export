version: '3'
services:
  db:
    image: mongo:3.6
    hostname: mongo
    volumes:
      - ./:/clashleaders

  web:
    env_file: .env
    restart: 'no'
    # command: 'flask run --host=0.0.0.0 --port=80'
    depends_on:
      - db
    ports:
      - "8000:80"
    volumes:
      - ./clashleaders:/app/clashleaders
      - ./tests/:/app/tests
      - ./pytest.ini:/app/pytest.ini
      - ./setup.cfg:/app/setup.cfg
      - ./caddy/Caddyfile.local:/etc/Caddyfile
      - .ipython/web:/root/.ipython/profile_default

  scheduler:
    env_file: .env
    restart: 'no'
    volumes:
      - ./clashleaders:/app/clashleaders
      - .ipython/scheduler:/root/.ipython/profile_default
    depends_on:
      - db
